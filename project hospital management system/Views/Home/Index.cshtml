@{
    ViewBag.Title = "Dashboard";
}

<div class="dashboard-header">
    <div class="row">
        <div class="col-md-8">
            <h1><i class="fa fa-tachometer"></i> Dashboard</h1>
            <p class="lead">Welcome @(string.IsNullOrEmpty(ViewBag.UserFullName) ? "User" : ViewBag.UserFullName)! <small>@ViewBag.UserRole</small></p>
        </div>
        <div class="col-md-4 text-right">
            <div class="date-time-widget">
                <div id="current-date" class="text-muted"></div>
                <div id="current-time" class="text-primary"></div>
            </div>
        </div>
    </div>
</div>

<!-- Statistics Cards -->
<div class="row stats-cards">
    <div class="col-md-4 col-sm-6">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-xs-3">
                        <i class="fa fa-users fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                        <div class="huge">@ViewBag.PatientCount</div>
                        <div>Patients</div>
                    </div>
                </div>
            </div>
            <a href="@Url.Action("Index", "Patient")">
                <div class="panel-footer">
                    <span class="pull-left">View Details</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </a>
        </div>
    </div>
    <div class="col-md-4 col-sm-6">
        <div class="panel panel-green">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-xs-3">
                        <i class="fa fa-user-md fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                        <div class="huge">@ViewBag.DoctorCount</div>
                        <div>Doctors</div>
                    </div>
                </div>
            </div>
            <a href="@Url.Action("Index", "Doctor")">
                <div class="panel-footer">
                    <span class="pull-left">View Details</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </a>
        </div>
    </div>
    <div class="col-md-4 col-sm-6">
        <div class="panel panel-yellow">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-xs-3">
                        <i class="fa fa-calendar fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                        <div class="huge">@ViewBag.AppointmentCount</div>
                        <div>Appointments</div>
                    </div>
                </div>
            </div>
            <a href="@Url.Action("Index", "Appointment")">
                <div class="panel-footer">
                    <span class="pull-left">View Details</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </a>
        </div>
    </div>
    <div class="col-md-4 col-sm-6">
        <div class="panel panel-red">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-xs-3">
                        <i class="fa fa-medkit fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                        <div class="huge">@ViewBag.MedicationCount</div>
                        <div>Medications</div>
                    </div>
                </div>
            </div>
            <a href="@Url.Action("Index", "Medication")">
                <div class="panel-footer">
                    <span class="pull-left">View Details</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </a>
        </div>
    </div>
    <div class="col-md-4 col-sm-6">
        <div class="panel panel-info">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-xs-3">
                        <i class="fa fa-file-text-o fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                        <div class="huge">@ViewBag.PrescriptionCount</div>
                        <div>Prescriptions</div>
                    </div>
                </div>
            </div>
            <a href="@Url.Action("Index", "Prescription")">
                <div class="panel-footer">
                    <span class="pull-left">View Details</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </a>
        </div>
    </div>
    <div class="col-md-4 col-sm-6">
        <div class="panel panel-success">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-xs-3">
                        <i class="fa fa-money fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                        <div class="huge">@ViewBag.InvoiceCount</div>
                        <div>Invoices</div>
                    </div>
                </div>
            </div>
            <a href="@Url.Action("Index", "Invoice")">
                <div class="panel-footer">
                    <span class="pull-left">View Details</span>
                    <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
                    <div class="clearfix"></div>
                </div>
            </a>
        </div>
    </div>
</div>

<!-- Quick Access Buttons -->
<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-rocket"></i> Quick Actions</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-2 col-sm-4 col-xs-6">
                        <a href="@Url.Action("Create", "Patient")" class="btn btn-primary btn-block">
                            <i class="fa fa-user-plus fa-2x"></i><br>
                            New Patient
                        </a>
                    </div>
                    <div class="col-md-2 col-sm-4 col-xs-6">
                        <a href="@Url.Action("Create", "Appointment")" class="btn btn-success btn-block">
                            <i class="fa fa-calendar-plus-o fa-2x"></i><br>
                            New Appointment
                        </a>
                    </div>
                    <div class="col-md-2 col-sm-4 col-xs-6">
                        <a href="@Url.Action("Create", "MedicalRecord")" class="btn btn-info btn-block">
                            <i class="fa fa-stethoscope fa-2x"></i><br>
                            New Record
                        </a>
                    </div>
                    <div class="col-md-2 col-sm-4 col-xs-6">
                        <a href="@Url.Action("Create", "Prescription")" class="btn btn-warning btn-block">
                            <i class="fa fa-file-text fa-2x"></i><br>
                            New Prescription
                        </a>
                    </div>
                    <div class="col-md-2 col-sm-4 col-xs-6">
                        <a href="@Url.Action("Create", "Invoice")" class="btn btn-danger btn-block">
                            <i class="fa fa-credit-card fa-2x"></i><br>
                            New Invoice
                        </a>
                    </div>
                    <div class="col-md-2 col-sm-4 col-xs-6">
                        <a href="@Url.Action("Register", "Account")" class="btn btn-default btn-block">
                            <i class="fa fa-user-plus fa-2x"></i><br>
                            New User
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Today's Appointments and Recent Activity -->
<div class="row">
    <div class="col-md-6">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-calendar-check-o"></i> Today's Appointments</h3>
            </div>
            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Patient</th>
                                <th>Doctor</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (ViewBag.TodaysAppointments != null && ViewBag.TodaysAppointments.Count > 0)
                            {
                                foreach (var appointment in ViewBag.TodaysAppointments)
                                {
                                    <tr>
                                        <td>@appointment.AppointmentDate.ToString("HH:mm")</td>
                                        <td>@appointment.Patient.Name</td>
                                        <td>@appointment.Doctor.Name</td>
                                        <td>
                                            @{
                                                string statusClass = "";
                                                switch (appointment.Status)
                                                {
                                                    case "Scheduled":
                                                        statusClass = "label label-primary";
                                                        break;
                                                    case "Completed":
                                                        statusClass = "label label-success";
                                                        break;
                                                    case "Cancelled":
                                                        statusClass = "label label-danger";
                                                        break;
                                                    default:
                                                        statusClass = "label label-default";
                                                        break;
                                                }
                                            }
                                            <span class="@statusClass">@appointment.Status</span>
                                        </td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="4" class="text-center">No appointments scheduled for today</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <div class="text-right">
                    <a href="@Url.Action("Index", "Appointment")">View All Appointments <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="panel panel-yellow">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-money"></i> Pending Invoices</h3>
            </div>
            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Invoice #</th>
                                <th>Patient</th>
                                <th>Date</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (ViewBag.PendingInvoices != null && ViewBag.PendingInvoices.Count > 0)
                            {
                                foreach (var invoice in ViewBag.PendingInvoices)
                                {
                                    <tr>
                                        <td>@invoice.InvoiceId</td>
                                        <td>@invoice.Patient.Name</td>
                                        <td>@invoice.DateIssued.ToString("yyyy-MM-dd")</td>
                                        <td>@string.Format("{0:C}", invoice.TotalAmount)</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="4" class="text-center">No pending invoices</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <div class="text-right">
                    <a href="@Url.Action("Index", "Invoice")">View All Invoices <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        $(document).ready(function () {
            // Update date and time
            function updateDateTime() {
                var now = new Date();
                var date = now.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                var time = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit' });

                $('#current-date').text(date);
                $('#current-time').text(time);
            }

            // Update time every second
            updateDateTime();
            setInterval(updateDateTime, 1000);
        });
    </script>
}